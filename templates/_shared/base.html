<!doctype html>
<html lang="pt-br" class="h-full">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}CRUD Produtos{% endblock %}</title>

  <!-- Tailwind CDN (para o desafio). Em produção, prefira build local -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class', theme: { extend: { colors: { brand: { 600: '#4f46e5', 700: '#4338ca' } } } } };
    // aplica tema salvo ou preferência do sistema
    (function () {
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (saved === 'dark' || (!saved && prefersDark)) document.documentElement.classList.add('dark');
    })();
  </script>

  <!-- Seu CSS (borda/padding de inputs, toasts etc.) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <!-- JS comum: tema, toasts e autofocus fallback -->
  <script src="{{ url_for('static', filename='js/ui.js') }}" defer></script>
</head>

<body
  class="min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-50 text-slate-800 dark:from-slate-950 dark:via-slate-950 dark:to-slate-900 dark:text-slate-100">
  <nav class="sticky top-0 z-40 backdrop-blur bg-slate-900/90 text-white border-b border-white/10">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a class="font-semibold tracking-wide hover:opacity-90 transition"
        href="{{ url_for('products.lista_produtos') }}">CRUD Produtos</a>
      <div class="flex items-center gap-2">
        <!-- Toggle de tema (sol/lua) -->
        <button id="themeToggle"
          class="relative inline-flex h-8 w-14 items-center rounded-full border border-white/20 bg-white/10 hover:bg-white/15 transition"
          type="button" role="switch" aria-checked="false" aria-label="Alternar tema">
          <span class="sr-only">Alternar tema</span>

          <!-- Sol -->
          <svg id="iconSun" xmlns="http://www.w3.org/2000/svg"
            class="absolute left-1.5 h-4 w-4 text-yellow-300 transition-opacity" viewBox="0 0 24 24"
            fill="currentColor">
            <path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z" />
            <path
              d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41" />
          </svg>

          <!-- Lua -->
          <svg id="iconMoon" xmlns="http://www.w3.org/2000/svg"
            class="absolute right-1.5 h-4 w-4 text-slate-200 transition-opacity" viewBox="0 0 24 24"
            fill="currentColor">
            <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79Z" />
          </svg>

          <!-- Knob -->
          <span id="themeKnob"
            class="absolute left-1.5 top-1.5 h-5 w-5 rounded-full bg-white shadow transition-transform"></span>
        </button>
        <a class="inline-flex items-center gap-2 rounded-lg border border-white/20 px-3 py-1.5 hover:bg-white/10 transition"
          href="{{ url_for('auth.logout') }}">Sair</a>
      </div>
    </div>
  </nav>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <!-- container invisível p/ toasts virem do flash -->
    <div id="flashed-messages" class="hidden">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% for category, message in messages %}
      <div data-category="{{ category }}" data-message="{{ message|e }}"></div>
      {% endfor %}
      {% endwith %}
    </div>

    {% block content %}{% endblock %}
  </main>

  <div id="toastWrap" class="toast-wrap"></div>
</body>

</html>